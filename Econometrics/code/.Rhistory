# 计算基尼系数
gini_coefficient <- calculate_gini(data$INCTOT)
print(paste("Gini Coefficient:", gini_coefficient))
# 计算基尼系数的函数
calculate_gini <- function(income) {
n <- length(income)
sorted_income <- sort(income)
cumulative_income <- cumsum(as.numeric(sorted_income))
total_income <- sum(sorted_income)
cumulative_income_ratio <- cumulative_income / total_income
cumulative_population_ratio <- (1:n) / n
gini_area <- sum((cumulative_income_ratio[-1] - cumulative_income_ratio[-n]) * (cumulative_population_ratio[-1] + cumulative_population_ratio[-n])) / 2
gini_coefficient <- 1 - 2 * gini_area
return(gini_area)
}
# 计算基尼系数
gini_area <- calculate_gini(data$INCTOT)
print(paste("Gini area:", gini_area))
# 计算基尼系数的函数
calculate_gini <- function(income,cumulative_population,cumulative_income) {
n <- length(income)
sorted_income <- sort(income)
cumulative_income <- cumsum(as.numeric(sorted_income))
total_income <- sum(sorted_income)
cumulative_income_ratio <- cumulative_income / total_income
cumulative_population_ratio <- (1:n) / n
gini_area <- sum((cumulative_income_ratio[-1] - cumulative_income_ratio[-n]) * (cumulative_population_ratio[-1] + cumulative_population_ratio[-n])) / 2
gini_coefficient <- 1 - 2 * gini_area
return(gini_area)
}
# 计算基尼系数的函数
calculate_gini <- function(cumulative_population,cumulative_income) {
gini_area <- sum((cumulative_income[-1] - cumulative_income[-n]) * (cumulative_population[-1] + cumulative_population[-n])) / 2
gini_coefficient <- 1 - 2 * gini_area
return(gini_area)
}
# 计算基尼系数
gini_area <- calculate_gini(data$INCTOT)
# 计算基尼系数
gini_area <- calculate_gini(cumulative_population,cumulative_income)
print(paste("Gini area:", gini_area))
# gini_coefficient <- calculate_gini(data$INCTOT)
# gini_coefficient <- calculate_gini(data$INCTOT)
# print(paste("Gini Coefficient:", gini_coefficient))
# 计算基尼系数的函数
calculate_gini <- function(cumulative_population,cumulative_income) {
gini_area <- sum((cumulative_income[-1] - cumulative_income[-n]) * (cumulative_population[-1] - cumulative_population[-n])) / 2
gini_coefficient <- 1 - 2 * gini_area
return(gini_area)
}
# 计算基尼系数
gini_area <- calculate_gini(cumulative_population,cumulative_income)
print(paste("Gini area:", gini_area))
# 计算基尼系数的函数
calculate_gini <- function(cumulative_population,cumulative_income) {
gini_area <- sum((cumulative_income[-1] - cumulative_income[-n]) * (cumulative_population[-1] + cumulative_population[-n])) / 2
gini_coefficient <- 1 - 2 * gini_area
return(gini_area)
}
# 计算基尼系数
gini_area <- calculate_gini(cumulative_population,cumulative_income)
print(paste("Gini area:", gini_area))
# 计算基尼系数的函数
calculate_gini <- function(cumulative_population,cumulative_income) {
gini_area <- sum((cumulative_income) * (cumulative_population[-1] - cumulative_population[-n])) / 2
gini_coefficient <- 1 - 2 * gini_area
return(gini_area)
}
# 计算基尼系数
gini_area <- calculate_gini(cumulative_population,cumulative_income)
return(gini_area)
# 计算基尼系数的函数
calculate_gini <- function(cumulative_population,cumulative_income) {
gini_area <- sum((cumulative_income[-1]) * (cumulative_population[-1] - cumulative_population[-n])) / 2
gini_coefficient <- 1 - 2 * gini_area
return(gini_area)
}
# 计算基尼系数
gini_area <- calculate_gini(cumulative_population,cumulative_income)
print(paste("Gini area:", gini_area))
# gini_coefficient <- calculate_gini(data$INCTOT)
# gini_coefficient <- calculate_gini(data$INCTOT)
# print(paste("Gini Coefficient:", gini_coefficient))
# gini_coefficient <- calculate_gini(data$INCTOT)
# print(paste("Gini Coefficient:", gini_coefficient))
# gini_coefficient <- calculate_gini(data$INCTOT)
# print(paste("Gini Coefficient:", gini_coefficient))
# gini_coefficient <- calculate_gini(data$INCTOT)
# print(paste("Gini Coefficient:", gini_coefficient))
# 计算基尼系数的函数
calculate_gini <- function(cumulative_population,cumulative_income) {
gini_area <- sum((cumulative_income[-1]) * (cumulative_population[-1] - cumulative_population[-n])) / 2
gini_coefficient <- 1 - 2 * gini_area
return(gini_coefficient)
}
# 计算基尼系数
gini_area <- calculate_gini(cumulative_population,cumulative_income)
print(paste("Gini area:", gini_area))
# 计算基尼系数的函数
calculate_gini <- function(cumulative_population,cumulative_income) {
gini_area <- sum((cumulative_income[-1]) * (cumulative_population[-1] - cumulative_population[-n])) / 2
gini_coefficient <- 1 - 2 * gini_area
return(gini_coefficient)
}
# 计算基尼系数
gini_coefficient <- calculate_gini(cumulative_population,cumulative_income)
print(paste("gini_coefficient:", gini_coefficient))
# 计算基尼系数
lorenz_data$prev_population <- c(0, lorenz_data$cumulative_population[-n])
lorenz_data$prev_income <- c(0, lorenz_data$cumulative_income[-n])
gini_index <- sum((lorenz_data$cumulative_population - lorenz_data$prev_population) *
(lorenz_data$cumulative_income + lorenz_data$prev_income))
gini_coefficient <- 1 - 2 * gini_index
gini_coefficient
# 计算基尼系数的改进版
n <- nrow(lorenz_data)
gini_index <- sum((lorenz_data$cumulative_population[-1] - lorenz_data$cumulative_population[-n]) *
(lorenz_data$cumulative_income[-1] + lorenz_data$cumulative_income[-n]))
gini_coefficient <- 1 - gini_index
gini_coefficient
data7 <- rio::import("caschool.dta")
ggplot(data=data7,aes(x=str,y=testscr))+
geom_point() +
geom_smooth(method = "lm", se = F, color = "blue") +
geom_smooth(method = "loess", se = F, color = "red")
labs(title = "scatter plot", x = "student teacher ratio", y = "testscore")
library(ggplot2)
data7 <- rio::import("caschool.dta")
ggplot(data=data7,aes(x=str,y=testscr))+
geom_point() +
geom_smooth(method = "lm", se = F, color = "blue") +
geom_smooth(method = "loess", se = F, color = "red")
labs(title = "scatter plot", x = "student teacher ratio", y = "testscore")
data7 <- rio::import("wg88.dta")
ggplot(data=data7,aes(x=str,y=testscr))+
geom_point() +
geom_smooth(method = "lm", se = F, color = "blue") +
geom_smooth(method = "loess", se = F, color = "red")
labs(title = "scatter plot", x = "student teacher ratio", y = "testscore")
data7 <- rio::import("wg88.dta")
ggplot(data=data7,aes(x=lgwage,y=schyear))+
geom_point() +
geom_smooth(method = "lm", se = F, color = "blue") +
geom_smooth(method = "loess", se = F, color = "red")
labs(title = "scatter plot", x = "student teacher ratio", y = "testscore")
data7 <- rio::import("caschool.dta")
ggplot(data=data7,aes(x=avginc,y=testscr))+
geom_point() +
geom_smooth(method = "lm", se = F, color = "blue") +
geom_smooth(method = "loess", se = F, color = "red")
labs(title = "scatter plot", x = "student teacher ratio", y = "testscore")
data7 <- rio::import("caschool.dta")
ggplot(data=data7,aes(x=avginc,y=testscr))+
geom_point() +
geom_smooth(method = "lm", se = F, color = "blue") +
geom_smooth(method = "loess", se = F, color = "red")
labs(title = "scatter plot", x = "distric average income", y = "testscore")
data7 <- data7 %>%
mutate(
avginc2=avginc^2,
avginc3=avginc^3
)
library("dplyr")
data7 <- data7 %>%
mutate(
avginc2=avginc^2,
avginc3=avginc^3
)
m2 <- lm(testscr~avginc+avginc2+avginc3, data = data7)
summary(m2)
plot(data7$avginc,data7$testscr,col="blue",pch=16)
abline(lm(testscr~avginc, data= data7, col="black"))
avginc3_fit <- predict(lm(testscr~avginc+avginc2+avginc3, data = data7))
points(data7$avginc,avginc3_fit,col="red",pch=1)
log_fit <- predict(lm(testscr~log(avginc),data=data7))
points(data7$avginc, log_fit, col="green",pch=1)
pf(37.69,2,416)
pf(37.69,2,416, lower.tail = F)
m3 <- lm(testscr ~ log(avginc), data = data7)
summary(m3)
data3 <- rio::import(wg88.dta)
data3 <- rio::import("wg88.dta")
data3 <- rio::import("wg88.dta")
model3 <- lm(lgwg88c ~ schyear+asex+schsex+cp+exper+expsq+minor+
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21+zprvn34+zprvn41+zprvn42+
zprvn44+zprvn53+zprvn62, data = data6)
data3 <- rio::import("wg88.dta")
model3 <- lm(lgwg88c ~ schyear+asex+cp+exper+expsq+minor+
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21+zprvn34+zprvn41+zprvn42+
zprvn44+zprvn53+zprvn62, data = data3)
summary(model3)
m4 <- lm(log(log(testscr) + log(avginc), data = data7))
summary(m4)
data7 <- rio::import("caschool.dta")
m4 <- lm(log(log(testscr) + log(avginc), data = data7))
summary(m4)
m4 <- lm(log(log(testscr) + log(avginc), data = data7))
m4 <- lm(log(testscr) + log(avginc), data = data7)
m4 <- lm(log(testscr) + log(avginc), data = data7)
summary(m4)
m3 <- lm(testscr ~ log(avginc), data = data7)
summary(m3)
m4 <- lm(log(testscr) + log(avginc), data = data7)
m4 <- lm(log(testscr) + log(avginc), data = data7)
m4 <- lm(log(testscr) ~ log(avginc), data = data7)
summary(m4)
data7 <- data7 %>%
mutate(lntestscr=log(testscr))
points(data7$lntestscr, data7$avginc, col="pink",pch=1.5)
plot(data7$avginc,data7$testscr,col="blue",pch=16)
abline(lm(testscr~avginc, data= data7, col="black"))
avginc3_fit <- predict(lm(testscr~avginc+avginc2+avginc3, data = data7))
data7 <- data7 %>%
mutate(lntestscr=log(testscr))
points(data7$lntestscr, data7$avginc, col="pink",pch=1.5)
data7 <- data7 %>%
mutate(lntestscr=log(testscr))
points(data7$lntestscr, data7$avginc, col="pink",pch=1.5)
data7 <- data7 %>%
mutate(lntestscr=log(testscr))
points(data7$lntestscr, data7$avginc, col="pink",pch=1.5)
library(ggplot2)
data7 <- rio::import("caschool.dta")
ggplot(data=data7,aes(x=avginc,y=testscr))+
geom_point() +
geom_smooth(method = "lm", se = F, color = "blue") +
geom_smooth(method = "loess", se = F, color = "red")
labs(title = "scatter plot", x = "distric average income", y = "testscore")
library("dplyr")
data7 <- data7 %>%
mutate(
avginc2=avginc^2,
avginc3=avginc^3
)
m2 <- lm(testscr~avginc+avginc2+avginc3, data = data7)
summary(m2)
plot(data7$avginc,data7$testscr,col="blue",pch=16)
abline(lm(testscr~avginc, data= data7, col="black"))
avginc3_fit <- predict(lm(testscr~avginc+avginc2+avginc3, data = data7))
points(data7$avginc,avginc3_fit,col="red",pch=1)
log_fit <- predict(lm(testscr~log(avginc),data=data7))
points(data7$avginc, log_fit, col="green",pch=1)
pf(37.69,2,416, lower.tail = F)
m3 <- lm(testscr ~ log(avginc), data = data7)
summary(m3)
data3 <- rio::import("wg88.dta")
model3 <- lm(lgwg88c ~ schyear+asex+cp+exper+expsq+minor+
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21+zprvn34+zprvn41+zprvn42+
zprvn44+zprvn53+zprvn62, data = data3)
summary(model3)
m4 <- lm(log(testscr) ~ log(avginc), data = data7)
summary(m4)
m4 <- lm(log(testscr)~log(avginc), data=data7)
summary(m4)
data7 <- data7 %>%
mutate(lntestscr=log(testscr))
points(data7$lntestscr, data7$avginc, col="pink",pch=1.5)
data7 <- data7 %>%
mutate(lntestscr=log(testscr))
points(data7$lntestscr, data7$avginc, col="yellow",pch=1.5)
install.packages("haven")
library(haven)
model<-nls(
testscr~b0*(1-exp(-1*b1*(avginc-b2))),
data = data7,
start = list(b0=720,b1=0.1,b2=10),
summary(model)
)
summary(model)
model<-nls(
testscr~b0*(1-exp(-1*b1*(avginc-b2))),
data = data7,
start = list(b0=720,b1=0.1,b2=10),
)
summary(model)
fuck
nonlfit_curve <- function(x){}
nonlfit_curve <- function(x){
predict(nls(
testscr ~ b0*(1-exp(-1*b1*(avginc-b2))),
data = data7,
start = list(b0=720,b1=0.2,b2=10)
),
newdata = data.frame(avginc = x))
}
curve(nonlfit_curve(x), col = "green", lwd = 2, add = TRUE)
data7 <- rio::import("caschool.dta")
nonlfit_curve <- function(x){
predict(nls(
testscr ~ b0*(1-exp(-1*b1*(avginc-b2))),
data = data7,
start = list(b0=720,b1=0.2,b2=10)
),
newdata = data.frame(avginc = x))
}
curve(nonlfit_curve(x), col = "green", lwd = 2, add = TRUE)
install.packages("quantreg")
library(quantreg)
fit <- rq(testscr~avginc, tau = seq(0.1, 0.9, by = 0.1), data = data7)
summary(fit)
plot(summary_fit, parm = "avginc", main = "coefficient")
summary_fit <- summary(fit)
plot(summary_fit, parm = "avginc", main = "coefficient")
data7 <- rio::import("caschool.dta")
install.packages("quantreg")
library(quantreg)
m2 <- rq(testscr ~avginc, tau=0.1, data = data7)
summary(m2)
m2 <- rq(testscr ~avginc, tau=0.25, data = data7)
summary(m2)
m2 <- rq(testscr ~avginc, tau=0.5, data = data7)
summary(m2)
m2 <- rq(testscr ~avginc, tau=0.75, data = data7)
summary(m2)
m2 <- rq(testscr ~avginc, tau=0.9, data = data7)
summary(m2)
fit <- rq(testscr~avginc, tau = seq(0.1, 0.9, by = 0.1), data = data7)
summary_fit <- summary(fit)
plot(summary_fit, parm = "avginc", main = "coefficient")
data3 <- rio::import("wg88.dta")
fit <- rq( gwg88c ~ schyear + asex + exper + expsq + cp + minor +
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21++zprvn34+zprvn41+zprvn42+zprvn44+
zprvn53+zprvn62, tau = seq(0.1, 0.9, by = 0.1),data = data3)
smmary_fit <- summary(fit)
plit(summary_fit, parm = "schyear")
data3 <- rio::import("wg88.dta")
fit <- rq( gwg88c ~ schyear + asex + exper + expsq + cp + minor +
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21++zprvn34+zprvn41+zprvn42+zprvn44+
zprvn53+zprvn62, tau = seq(0.1, 0.9, by = 0.1),data = data3)
smmary_fit <- summary(fit)
plot(summary_fit, parm = "schyear")
wage
data3 <- rio::import("wg88.dta")
fit <- rq( wage88c ~ schyear + asex + exper + expsq + cp + minor +
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21++zprvn34+zprvn41+zprvn42+zprvn44+
zprvn53+zprvn62, tau = seq(0.1, 0.9, by = 0.1),data = data3)
smmary_fit <- summary(fit)
plot(summary_fit, parm = "schyear")
data3 <- rio::import("wg88.dta")
fit <- rq( wage88c ~ schyear + asex + exper + expsq + cp + minor +
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21++zprvn34+zprvn41+zprvn42+zprvn44+
zprvn53+zprvn62, tau = seq(0.1, 0.9, by = 0.1),data = data3)
smmary_fit <- summary(fit)
plot(summary_fit, parm = "schyear")
data3 <- rio::import("wg88.dta")
fit <- rq( lgwg88c ~ schyear + asex + exper + expsq + cp + minor +
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21++zprvn34+zprvn41+zprvn42+zprvn44+
zprvn53+zprvn62, tau = seq(0.1, 0.9, by = 0.1),data = data3)
smmary_fit <- summary(fit)
plot(summary_fit, parm = "schyear")
fit <- rq( lgwg88c ~ schyear + asex + exper + expsq + cp + minor +
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21++zprvn34+zprvn41+zprvn42+zprvn44+
zprvn53+zprvn62, tau = seq(0.1, 0.9, by = 0.1),data = data3)
smmary_fit <- summary(fit)
plot(summary_fit, parm = "schyear")
plot(summary_fit, parm = "schyear", main = "Coefficient for school year")
plot(summary_fit, parm = "schyear", main = "Coefficient for school year")
setwd("C:\Users\Lenovo\Desktop\2025_Spring\Econometrics\code")
setwd("C:/Users/Lenovo/Desktop/2025_Spring/Econometrics/code")
data3 <- rio::import("wg88.dta")
fit <- rq( lgwg88c ~ schyear + asex + exper + expsq + cp + minor +
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21++zprvn34+zprvn41+zprvn42+zprvn44+
zprvn53+zprvn62, tau = seq(0.1, 0.9, by = 0.1),data = data3)
smmary_fit <- summary(fit)
plot(summary_fit, parm = "schyear", main = "Coefficient for school year")
setwd("C:/Users/Lenovo/Desktop/2025_Spring/Econometrics/code")
data3 <- rio::import("wg88.dta")
library(quantreg)
fit <- rq( lgwg88c ~ schyear + asex + exper + expsq + cp + minor +
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21++zprvn34+zprvn41+zprvn42+zprvn44+
zprvn53+zprvn62, tau = seq(0.1, 0.9, by = 0.1),data = data3)
smmary_fit <- summary(fit)
plot(summary_fit, parm = "schyear", main = "Coefficient for school year")
install(mgcv)
install.packages(mgcv)
install.packages("mgcv")
library(mgcv)
nl2 <- gam(lgwg88c ~ schyear + asex + exper + expsq + cp + minor +
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21++zprvn34+zprvn41+zprvn42+zprvn44+
zprvn53+zprvn62, tau = seq(0.1, 0.9, by = 0.1),data = data3)
plot(nl2)
install.packages("mgcv")
install.packages("mgcv")
library(mgcv)
data3 <- rio::import("wg88.dta")
nl2 <- gam(lgwg88c ~ schyear + asex + exper + expsq + cp + minor +
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21++zprvn34+zprvn41+zprvn42+zprvn44+
zprvn53+zprvn62, tau = seq(0.1, 0.9, by = 0.1),data = data3)
plot(nl2)
nl2 <- gam(lgwg88c ~ schyear + asex + s(exper) + expsq + cp + minor +
ow2+ow3+ow4+ow5+
oc2+oc3+oc4+
sec1+sec3+sec4+sec5+sec6+sec7+sec8+sec9+sec10+sec11+sec12+
zprvn11+zprvn14+zprvn21++zprvn34+zprvn41+zprvn42+zprvn44+
zprvn53+zprvn62,data = data3)
plot(nl2)
plot(nl2)
plot(nl2)
install.packages("car")
library(car)
data(UN)
attach(UN)
view(UN)
View(UN)
colnames(UN)
plot(ppgdp, infantMortality)
plot(log(ppgdp), log(infantMortality))
loglog.fit <- lm(I(log(infantMortality))~I(log(ppgdp)))
curve(exp(coef(loglog.fit)[1])+coef(loglog.fit[2]*log(x)),5,43000,add=T,col="red")
loglog.fit <- lm(I(log(infantMortality))~I(log(ppgdp)))
curve(exp(coef(loglog.fit)[1])+coef(loglog.fit*log(x))[2],5,43000,add=T,col="red")
curve(exp(coef(loglog.fit)[1]+coef(loglog.fit[2]*log(x))),5,43000,add=T,col="red")
loglog.fit <- lm(I(log(infantMortality))~I(log(ppgdp)))
curve(exp(coef(loglog.fit)[1]+coef(loglog.fit[2]*log(x))),5,43000,add=T,col="red")
curve
curve
curve
loglog.fit <- lm(I(log(infantMortality))~I(log(ppgdp)))
curve(exp(coef(loglog.fit)[1]+coef(loglog.fit)[2]*log(x)),5,43000,add=T,col="red")
loglog.fit <- lm(I(log(infantMortality))~I(log(ppgdp)))
curve(exp(coef(loglog.fit)[1]+coef(loglog.fit)[2]*log(x)),5,43000,add=T,col="red")
loglog.fit <- lm(I(log(infantMortality))~I(log(ppgdp)))
curve(exp(coef(loglog.fit)[1]+coef(loglog.fit)[2]*log(x)),5,43000,add=T,col="red")
plot(log(ppgdp), log(infantMortality))
plot(ppgdp, infantMortality)
loglog.fit <- lm(I(log(infantMortality))~I(log(ppgdp)))
curve(exp(coef(loglog.fit)[1]+coef(loglog.fit)[2]*log(x)),5,43000,add=T,col="red")
b0 <- coef(poly5.fit)[1]
b0 <- coef(poly5.fit)[1]
b0 <- coef(poly5.fit)[1]
b0 <- coef(poly5.fit)[1]
poly5.fit <- lm(infantMortality ~ ppgdp + I(ppgdp^2) + I(ppgdp^3) + I(ppgdp^4) + I(ppgdp^5))
plot(ppgdp, infantMortality)
poly5.fit <- lm(infantMortality ~ ppgdp + I(ppgdp^2) + I(ppgdp^3) + I(ppgdp^4) + I(ppgdp^5))
plot(ppgdp, infantMortality)
b0 <- coef(poly5.fit)[1]
b1 <- coef(poly5.fit)[2]
b2 <- coef(poly5.fit)[3]
b3 <- coef(poly5.fit)[4]
b4 <- coef(poly5.fit)[5]
b5 <- coef(poly5.fit)[6]
curve(b0+b1*x+b2*x^2+b3*x^3+b4*x^4+b5*x^5)
poly5.fit <- lm(infantMortality ~ ppgdp + I(ppgdp^2) + I(ppgdp^3) + I(ppgdp^4) + I(ppgdp^5))
plot(ppgdp, infantMortality)
b0 <- coef(poly5.fit)[1]
b1 <- coef(poly5.fit)[2]
b2 <- coef(poly5.fit)[3]
b3 <- coef(poly5.fit)[4]
b4 <- coef(poly5.fit)[5]
b5 <- coef(poly5.fit)[6]
curve(b0+b1*x+b2*x^2+b3*x^3+b4*x^4+b5*x^5,4,43000,add=T,col="red")
fit.jpw <- lm(infantMortality~1+ppgdp+I((ppgdp-1750)*(ppgdp>1750)))
b.0 <- coef(fit.jpw)[1]
b.0 <- coef(fit.jpw)[1]
b.0 <- coef(fit.jpw)[1]
fit.jpw <- lm(infantMortality~1+ppgdp+I((ppgdp-1750)*(ppgdp>1750)))
summary(fit.jpw)
b.0 <- coef(fit.jpw)[1]
b.1 <- coef(fit.jpw)[2]
b.2 <- coef(fit.jpw)[3]
x.0 <- seq(0, 1750,1)
x.1 <- seq(1750,42000,1)
y.0 <- b.0 + b.1*x.0
y.1 <- (b.0+b.1*1750+(b.1+b.2)*x.1)
plot(ppgdp, infantMortality)
lines(x.0, y.0, col="red")
lines(x.1, y.1, col="blue")
plot(ppgdp, infantMortality,pch=16,cex=0.5)
lines(x.0, y.0, col="red")
lines(x.1, y.1, col="blue")
plot(ppgdp, infantMortality,pch=16,cex=0.5)
lines(x.0, y.0, col="red",lwd=2)
lines(x.1, y.1, col="blue",lwd=2)
